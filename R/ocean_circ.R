#' Stochastic Ocean Circulation Model
#'
#' Dimensions 4. Longitude, latitude, and the diffusion coefficients Kx and Ky
#'
#' @param x Inputs of dimension (at least) 4. See below for details.
#' @param scale01 Default TRUE. For this function inputs are expected on a [0,1] range.
#' @param NPATHS how many simulations should be conducted for each set of inputs (the average is returned).
#' @return Let C(s) denote the concentration of dissolved oxygen at a location s = (lon, lat) in a rectangular domain Omega subset R2 representing the layer of the ocean being studied
#' @details a stochastic simulator
#' that models the concentration of oxygen in a thin water
#' layer (around 2000 m deep) in the South Atlantic ocean
#' (McKeague et al., 2005, Herbei and Berliner, 2014).
#' For a specific
#' location within the domain, random paths of the process
#' are generated, producing noisy outcomes that approximate
#' the solution to the PDE at that location.
#' @references
#' Baker, Evan, et al. "Analyzing stochastic computer models: a review with opportunities." Statistical Science 37.1 (2022): 64-89.
#'
#' Herbei, Radu, and L. Mark Berliner. "Estimating ocean circulation: an MCMC approach with approximated likelihoods via the Bernoulli factory." Journal of the American Statistical Association 109.507 (2014): 944-954.
#' @export
#' @examples
#' n <- 10
#' x <- matrix(runif(4*n), nrow=n)
#' y <- apply(x, 1, ocean_circ)
ocean_circ = function(x, scale01=TRUE, NPATHS=1)
{
  v <- x
  #Default settings for simulator
  xy=c(-34.0, 11.0, -32.0, -3.0)
  lat0=-17.5
  domain=rep(0,4)
  domain[1]=xy[1]*111e3*cos(lat0*pi/180.0)
  domain[2]=xy[2]*111e3*cos(lat0*pi/180.0)
  domain[3]=xy[3]*111e3
  domain[4]=xy[4]*111e3
  N = 37
  M = 19
  delx=(domain[2]-domain[1])/(N-1)
  dely=(domain[4]-domain[3])/(M-1)

  # velocity vectors
  #U = read.table('inst/gridu.txt')
  #U =-U
  #V = read.table('inst/gridv.txt')
  #V = -V
  U = get_ocean_circ_U()
  V = get_ocean_circ_V()

  #this is needed only for the boundary values
  #OXY = as.matrix(read.table('inst/oxygengrid.txt'))
  OXY = get_ocean_circ_OXY()

  #unnormalize
  long = v[1] * (domain[2]-domain[1]) + domain[1]
  lat = v[2] * (domain[4]-domain[3]) + domain[3]
  KX = v[3] * 900 + 100
  KY = v[4] * 900 + 100

  sim = fk_simulator(domain, matrix(c(long,lat),nrow=1), U, V, KX,KY, OXY, NPATHS)
  return(mean(sim))
}


quackquack_ocean_circ <- function(){
  out <- list(input_dim=4)
  out$input_cat <- FALSE
  out$response_type <- "uni"

  RR <- cbind(c(0,0,0,0), c(1,1,1,1))
  rownames(RR) <- c("lon", "lat", "Kx", "Ky")
  out$input_range <- RR
  return(out)
}



# Private Ocean Circulation simulator
fk_simulator  = function(domain, sites, U, V, KX, KY, OXY, NPATHS){
  M = dim(OXY)[1]
  N = dim(OXY)[2]
  delx=(domain[2]-domain[1])/(N-1)
  dely=(domain[4]-domain[3])/(M-1)
  NOBS = dim(sites)[1]
  HH    = 1e7
  lam   = 1e-11

  OUT = matrix(0, nrow = NOBS, ncol = NPATHS)

  for(i in 1:NOBS){
    #print(i)
    for(kk in 1:NPATHS){
      xc = sites[i,1]
      yc = sites[i,2]

      tau=0;
      while( ((xc - domain[1])*(xc-domain[2])<0) & ( (yc-domain[3])*(yc-domain[4])<0)    ){

        #--------
        # find indices
        jx = ceiling( (xc - domain[1])/delx );
        ix = ceiling( (yc - domain[3])/dely );
        if (jx<=0){
          jx=1
        }
        else{
          if (jx>N){
            jx=N
          }
        }

        if (ix<=0){
          ix=1
        }
        else{
          if (ix>M) ix=M
        }
        #------------

        uc = U[ix,jx]
        vc = V[ix,jx]

        # Euler step
        xn = xc + HH * uc + sqrt(HH)*sqrt(2*KX)*stats::rnorm(1);
        yn = yc + HH * vc + sqrt(HH)*sqrt(2*KY)*stats::rnorm(1);

        xc=xn;
        yc=yn;
        tau = tau + HH;
      }
      JJ = ceiling( (xc - domain[1])/delx );
      II = ceiling( (yc - domain[3])/dely );

      if (JJ<=0){
        JJ=1
      }
      else{
        if (JJ>N) JJ=N
      }

      if (II<=0){
        II=1
      }
      else{
        if (II>M) II=M
      }
      OUT[i,kk] = OXY[II,JJ]*exp(-lam*tau)
    }
  }

  return(OUT)
}



get_ocean_circ_U <- function(){
  res <- matrix(c(-0.007284074,-0.007414825,-0.00766823,-0.007966879,-0.00828577
    ,-0.008203603,-0.007625472,-0.007275053,-0.007041329,-0.006824117
    ,-0.006306903,-0.006067243,-0.006447969,-0.007005514,-0.00776636
    ,-0.007830692,-0.007190736,-0.00648708,-0.006094904,-0.005621447
    ,-0.005400722,-0.005315943,-0.005674061,-0.005929962,-0.005588675
    ,-0.005204036,-0.00446941,-0.003963077,-0.003459391,-0.001888023
    ,-0.0007305593,3.609377e-05,0.0003522149,0.0004957701,0.0004164058
    ,2.726967e-05,0,0.005884003,0.005754012,0.005313111
    ,0.004728601,0.004582213,0.004621281,0.004998,0.005242717
    ,0.005406545,0.005378611,0.005319459,0.005264658,0.004936816
    ,0.004107843,0.002806809,0.001308965,-8.260377e-05,-0.000714683
    ,-0.0008918723,-0.00101323,-0.001677326,-0.002498551,-0.003330589
    ,-0.00409915,-0.004893292,-0.005037559,-0.00472044,-0.004023034
    ,-0.003533602,-0.002465678,-0.001279132,-0.0004638261,0.0003236671
    ,0.000567875,0.0006390574,0.0003671549,0,0.01321966
    ,0.01344249,0.01329587,0.01275927,0.01299326,0.01343476
    ,0.0136658,0.0140913,0.01413825,0.01392907,0.01332112
    ,0.01275277,0.01200262,0.01083292,0.009250708,0.007167488
    ,0.005287811,0.004589093,0.004676803,0.004353597,0.003348924
    ,0.002045954,0.0009060159,-0.0001551123,-0.001600482,-0.002247444
    ,-0.002332525,-0.00188255,-0.001413161,-0.00139458,-0.001029657
    ,-0.0004220764,0.0003900549,0.0009527769,0.001360097,0.0009959172
    ,0,0.006745597,0.007423414,0.007987552,0.008571355
    ,0.008638205,0.008312348,0.007918018,0.007885862,0.007528776
    ,0.006785138,0.006003026,0.005220582,0.00474591,0.004619867
    ,0.004588425,0.003932637,0.003505853,0.003633544,0.003974884
    ,0.003959336,0.00335796,0.002807756,0.002061655,0.0008124336
    ,-0.0003264306,-0.001326053,-0.001883085,-0.00207164,-0.00163097
    ,-0.001746796,-0.00206982,-0.002132274,-0.002106572,-0.00168064
    ,-0.00102165,-0.0006368592,0,0.005763606,0.006494166
    ,0.007301805,0.008192044,0.008249819,0.00778078,0.007791143
    ,0.008553371,0.00839823,0.007949203,0.008060551,0.008331802
    ,0.00916375,0.0106434,0.01195703,0.01146548,0.01096734
    ,0.01120306,0.01126288,0.01096686,0.01005851,0.01000172
    ,0.008796604,0.006628464,0.004412488,0.002492368,0.001438719
    ,0.0008679271,0.0007712721,0.0005000695,8.336405e-05,-0.0004244385
    ,-0.001120386,-0.001428353,-0.00128608,-0.000680544,0
    ,-0.01184938,-0.01104885,-0.009882469,-0.008443547,-0.007139139
    ,-0.005818619,-0.004818745,-0.004355905,-0.003797699,-0.00321485
    ,-0.002543406,-0.001761768,-0.0009184045,0.0002111308,0.001400723
    ,0.0027895,0.00322276,0.002811817,0.002284013,0.001801462
    ,0.001729062,0.00167632,0.001629572,0.001628643,0.001276153
    ,0.0009379844,0.0005292304,0.0001139341,-0.0001773088,-2.271047e-05
    ,0.000400401,0.0005598305,0.0002299133,0.0002342282,-2.444318e-05
    ,0.0001850452,0,-0.0225729,-0.02183058,-0.02077417
    ,-0.01919579,-0.01793822,-0.01671746,-0.01642257,-0.01744349
    ,-0.01728194,-0.0169689,-0.0170365,-0.01697571,-0.01686425
    ,-0.01694546,-0.01658929,-0.01494196,-0.01454005,-0.01592936
    ,-0.01740889,-0.0182356,-0.01786786,-0.01760273,-0.01587223
    ,-0.01355946,-0.01133741,-0.009776557,-0.009265282,-0.009033162
    ,-0.009015991,-0.008209,-0.007321493,-0.006741008,-0.006099138
    ,-0.005063713,-0.004175433,-0.003070502,0,-0.00856213
    ,-0.007908578,-0.007057022,-0.006058091,-0.005439597,-0.005085931
    ,-0.005325448,-0.005779383,-0.006037919,-0.0055844,-0.005138042
    ,-0.0047123,-0.004236766,-0.003638008,-0.003134282,-0.002496478
    ,-0.002290534,-0.002998917,-0.004187462,-0.005356725,-0.005833376
    ,-0.005812103,-0.004945509,-0.003714291,-0.002671102,-0.002143703
    ,-0.002189469,-0.002570679,-0.003224007,-0.003581024,-0.003949008
    ,-0.004441493,-0.00476358,-0.004575841,-0.004076337,-0.003310398
    ,0,-0.003576968,-0.002958975,-0.002012022,-0.0008009155
    ,0.0001258884,0.0004389473,0.0001998688,-0.0006107404,-0.001448543
    ,-0.002107048,-0.002562163,-0.002644624,-0.002434804,-0.001683386
    ,-0.0007191606,0.0005644507,0.001823142,0.00256459,0.002869529
    ,0.002817245,0.00274315,0.002650563,0.002744744,0.002885444
    ,0.002937903,0.002817124,0.002327512,0.001603487,0.0008145079
    ,0.0001134672,-0.0005950877,-0.001054551,-0.001402313,-0.001418016
    ,-0.001166931,-0.0007593429,0,0.008941591,0.009363875
    ,0.009838741,0.01011091,0.01040785,0.01010026,0.009644184
    ,0.008816276,0.008006132,0.006598272,0.005119365,0.004156039
    ,0.003330652,0.002793819,0.002652787,0.002792493,0.003124751
    ,0.003409017,0.003409706,0.003351891,0.003149371,0.002999662
    ,0.002699136,0.002260797,0.001979881,0.001679292,0.001084728
    ,0.0004937107,-0.0001382546,-0.000891683,-0.001448192,-0.001470832
    ,-0.001173716,-0.0008825048,-0.0004272464,0.0002109535,0
    ,0.01522171,0.01509538,0.01465642,0.01359776,0.01259089
    ,0.01149428,0.01081711,0.01054609,0.01047086,0.01033551
    ,0.01004102,0.009573046,0.009325896,0.009095751,0.008784004
    ,0.008422685,0.008121883,0.007966571,0.007581634,0.00696758
    ,0.005954344,0.004784589,0.003611111,0.002519613,0.001622256
    ,0.0007786601,7.292518e-05,-0.0005561102,-0.0006267716,-0.0008596186
    ,-0.0008452911,-0.0005877467,-0.0002258825,9.813025e-05,0.0002302158
    ,0.0004198975,0,0.01001173,0.009358569,0.008545341
    ,0.007570772,0.006647437,0.005934998,0.00562803,0.005501996
    ,0.005518063,0.005679664,0.00591586,0.005919989,0.006194122
    ,0.006293201,0.006347086,0.00647085,0.006697747,0.006872653
    ,0.00700582,0.006745574,0.005999506,0.004754555,0.003611497
    ,0.002618325,0.001792802,0.001100673,0.0006681646,0.0003625917
    ,0.0004509422,0.0007973695,0.001208128,0.001567559,0.002081106
    ,0.002349975,0.0023094,0.001672279,0,0.007793422
    ,0.006920158,0.005934308,0.004975101,0.004341459,0.003986838
    ,0.003780787,0.003820681,0.003769227,0.003736634,0.003691914
    ,0.0037908,0.003782876,0.003611671,0.003672262,0.00381599
    ,0.003898297,0.003506316,0.003070762,0.002539913,0.002093232
    ,0.001547392,0.000981056,0.0007248769,0.0004756915,0.0003658971
    ,0.0004847546,0.0007294967,0.0008441223,0.001295498,0.001858115
    ,0.002590264,0.003609919,0.003864073,0.003879799,0.003093878
    ,0,-0.005717909,-0.006579591,-0.007467021,-0.008126555
    ,-0.008438928,-0.008616384,-0.008622256,-0.008287004,-0.00799052
    ,-0.007633694,-0.00716825,-0.006511106,-0.005651393,-0.004567715
    ,-0.003582653,-0.003023457,-0.002638298,-0.002617319,-0.002693684
    ,-0.002674242,-0.002656893,-0.00261999,-0.002687389,-0.002519662
    ,-0.002153036,-0.001557341,-0.0006896428,0.0001685944,0.0007072405
    ,0.001324037,0.002168978,0.003298199,0.004268158,0.004366069
    ,0.004328575,0.00361079,0,-0.007119768,-0.007693299
    ,-0.008220295,-0.008284981,-0.008214158,-0.007960352,-0.007695985
    ,-0.007244717,-0.006773562,-0.006447372,-0.005929078,-0.005361971
    ,-0.004531065,-0.003432933,-0.00249195,-0.001792528,-0.001206674
    ,-0.0007675865,-0.0003523937,0.0001020833,0.0004774646,0.0009211893
    ,0.001268278,0.001672776,0.002321054,0.00304653,0.003806781
    ,0.004478488,0.004720667,0.00474817,0.004879287,0.004883663
    ,0.004711634,0.004198546,0.00359152,0.002579339,0
    ,0.01476735,0.01431716,0.01387061,0.01348495,0.01321245
    ,0.01322808,0.01308571,0.01292051,0.01254718,0.01209811
    ,0.01157344,0.01109256,0.01051379,0.009809262,0.008986707
    ,0.008226707,0.007220266,0.006393874,0.005571519,0.004679274
    ,0.004006596,0.003660933,0.003644224,0.003755824,0.004056389
    ,0.004313816,0.004621438,0.00471397,0.004565898,0.004118973
    ,0.003450454,0.002394652,0.001307047,0.0006742995,0.0002281969
    ,-0.0002162084,0,0.02263531,0.02220624,0.02192414
    ,0.02154698,0.02098615,0.0203227,0.01979659,0.01909018
    ,0.01835332,0.01772029,0.01685587,0.01595927,0.01482778
    ,0.01354885,0.01220738,0.01084512,0.009467207,0.008450789
    ,0.007296483,0.006108255,0.005131183,0.004441058,0.004065154
    ,0.003779169,0.003599875,0.003513143,0.003324458,0.003245887
    ,0.003313781,0.00322153,0.002854649,0.001973112,0.0007951467
    ,8.523111e-05,-0.0005395742,-0.0007054443,0,0.003263369
    ,0.002972168,0.002689476,0.002258579,0.00192779,0.001694545
    ,0.001627742,0.001670214,0.00171611,0.001832085,0.001966647
    ,0.002096307,0.002263285,0.002368526,0.002651749,0.002945148
    ,0.003425237,0.003699281,0.003520929,0.003322655,0.003036379
    ,0.00285366,0.002632247,0.00252992,0.002367436,0.00249507
    ,0.002470294,0.002758206,0.003199613,0.003665659,0.003813146
    ,0.003685096,0.003232446,0.002586706,0.001641911,0.001061703
    ,0,-0.01345295,-0.01372987,-0.01407652,-0.01459994
    ,-0.01463584,-0.01416729,-0.01363987,-0.01296407,-0.01241398
    ,-0.01175171,-0.01081819,-0.009803301,-0.008574985,-0.007333212
    ,-0.005893084,-0.004380498,-0.002840665,-0.001893681,-0.001382244
    ,-0.0009644352,-0.0009038405,-0.0009875268,-0.001153986,-0.001126871
    ,-0.0009755842,-0.00031215,0.000529549,0.001578612,0.002627228
    ,0.003689536,0.00433045,0.004838851,0.004928802,0.004382617
    ,0.003426107,0.002461874,0), byrow=TRUE, ncol=37)
  return(res)
}

get_ocean_circ_V <- function(){
  res <- matrix(c(0.002519374,0.002401148,0.002574838,0.002099935,0.001193093
                  ,0.000560759,-0.000372379,-0.0009064287,-0.001653895,-0.001526728
                  ,-0.0006064426,0.0002998796,0.001022362,0.00052215,-0.0007400022
                  ,-0.002237795,-0.002656067,-0.002885628,-0.004202541,-0.005767933
                  ,-0.005375327,-0.004609384,-0.004533393,-0.004474901,-0.00282018
                  ,-0.001334057,7.470458e-05,0.0009004473,0.002444924,0.002945531
                  ,0.00255611,0.002272748,0.002371811,0.002150328,0.000773631
                  ,-2.41592e-05,-0.0006120969,0.002808728,0.002850993,0.00309359
                  ,0.002624783,0.001135414,-0.0001954657,-0.0008625994,-0.001262827
                  ,-0.002021414,-0.002293977,-0.0009574376,0.0008278153,0.001821559
                  ,0.001573737,-0.0006861471,-0.003202733,-0.003725787,-0.003544663
                  ,-0.005030327,-0.006324154,-0.005730275,-0.00433152,-0.004390285
                  ,-0.005136238,-0.003466096,-0.002386508,-0.000606231,0.0002600109
                  ,0.0004306469,0.001513013,0.001634332,0.00194716,0.00228387
                  ,0.002353738,0.00133412,-0.0001455858,-0.0004822668,0.003138383
                  ,0.00386453,0.004449523,0.002745724,0.001195692,-0.0004760808
                  ,-0.001116024,-0.001469566,-0.001771039,-0.001585463,-0.0005495498
                  ,0.001264863,0.003436569,0.004188656,0.003243089,0.00121823
                  ,-0.001302693,-0.002744502,-0.004353893,-0.004575646,-0.00370173
                  ,-0.002773259,-0.002874444,-0.002817928,-0.002760537,-0.002418611
                  ,-0.001868077,-0.0003976572,-0.0004004874,-0.0001173668,0.0005081887
                  ,0.0003298088,0.001929395,0.002182236,0.001635688,0.0007283902
                  ,-0.0004321051,0.002525763,0.003640534,0.004996704,0.002271702
                  ,6.372397e-05,-0.0008684123,-0.002126209,-0.001539187,-0.00163627
                  ,-0.0008121025,0.0005228601,0.002984077,0.005332779,0.006276457
                  ,0.005274471,0.002001774,-0.001969799,-0.004060984,-0.004599746
                  ,-0.004074201,-0.002585163,-0.001532592,-0.001814654,-0.001516304
                  ,-0.001998328,-0.002402636,-0.00201253,-0.001049146,0.0003396732
                  ,0.0005147305,4.382779e-05,-0.000214371,0.0009592188,0.001474843
                  ,0.002484886,0.00164332,0.0004508084,0.001581377,0.002736199
                  ,0.003415709,0.002812383,0.002083375,0.0004951875,-0.00126066
                  ,-0.0006719934,6.07211e-05,0.0004400504,0.001622254,0.002872782
                  ,0.004357998,0.004957125,0.005589985,0.002589763,-0.00186233
                  ,-0.004109317,-0.004812786,-0.00339385,-0.002496142,-0.0009235446
                  ,0.0003044449,9.516946e-05,-0.0002762943,-0.001174661,-0.001577598
                  ,-0.001702976,-5.043616e-05,0.0008117759,0.0006817614,0.0002369997
                  ,0.0008826073,0.0005616777,0.0008662409,-0.0001977474,-0.000999272
                  ,0.0007359905,0.001777391,0.002989689,0.002444255,0.00157496
                  ,-0.0008385426,-0.004333767,-0.001198399,-0.0004154832,-0.001061633
                  ,-2.070787e-05,0.001071179,0.001842803,0.003305221,0.007256427
                  ,0.003650842,-0.002824578,-0.004702939,-0.00436218,-0.002015706
                  ,-0.00272338,0.001616777,0.004081123,0.004484326,0.003159209
                  ,0.0003079759,-0.0006541433,-0.0009869317,0.001066813,0.00173591
                  ,0.001496029,0.001694393,0.001894771,0.00115594,0.000949442
                  ,0.0003164888,-0.0002016838,-0.0004896996,-0.0001927001,-9.72853e-05
                  ,-0.0004056529,-0.001287631,-0.002312875,-0.003057032,-0.002331579
                  ,-0.001566939,-0.001508381,-0.0004930184,0.0007280823,0.00153691
                  ,0.002157771,0.002749513,0.001878156,-0.001107062,-0.003274591
                  ,-0.004057479,-0.00345183,-0.002696319,-0.0005937182,0.0008205524
                  ,0.001612258,0.001035315,-3.109025e-05,-0.0005374287,-0.001039988
                  ,-0.0003340407,-0.0001133779,0.0004391186,0.001341963,0.001109399
                  ,0.001406305,0.0004195043,-2.092306e-05,-0.0006614932,-0.001336964
                  ,-0.001104214,-0.001289679,-0.001009993,-0.001899713,-0.001950303
                  ,-0.001990222,-0.001952195,-0.001474749,-0.001084114,-0.0002521315
                  ,0.0008689753,0.002271413,0.002636065,0.003177882,0.002820085
                  ,0.0007799954,-0.001149443,-0.002679663,-0.003479237,-0.003806769
                  ,-0.003141399,-0.002058326,-0.001302241,-0.0009187573,-0.001078149
                  ,-0.001354677,-0.001174793,-0.00115987,-0.0006782999,-1.321861e-05
                  ,0.0001420284,-0.000752907,-0.001053679,-0.001979966,-0.003524698
                  ,-0.004752513,-0.002453665,-0.002657478,-0.00298777,-0.002226574
                  ,-0.002524167,-0.001953602,-0.002124121,-0.001921179,-0.003010561
                  ,-0.002875009,-0.001680988,-0.0004288766,0.0002540874,0.001185667
                  ,0.001495055,0.001738115,0.0009228348,-0.0002319128,-0.001292958
                  ,-0.00267746,-0.003316187,-0.003400068,-0.002811338,-0.001399716
                  ,-0.0005258994,-6.665587e-05,0.0002928212,0.0005523341,0.0004595877
                  ,0.0007810331,0.001768284,0.002233541,0.0004906917,-9.94251e-05
                  ,-0.001943207,-0.004175211,-0.006677519,-0.003403068,-0.004092313
                  ,-0.005045033,-0.003874141,-0.003152985,-0.001619197,-0.0001418432
                  ,2.422951e-06,-0.0001804565,-0.0003176953,-0.0003003698,0.000232688
                  ,0.0002814028,0.0002211165,-5.042489e-05,-0.0003016641,-0.001075203
                  ,-0.002011061,-0.002746876,-0.003710805,-0.004091375,-0.003944337
                  ,-0.002892051,-0.001669799,-0.0006771256,0.0002344597,0.0006494983
                  ,0.001046803,0.0008090801,0.001362806,0.001513852,0.001442226
                  ,-0.0006313259,-0.001748364,-0.003395036,-0.005294736,-0.00678528
                  ,-0.004198237,-0.004666316,-0.004617634,-0.003715829,-0.002251642
                  ,-0.001007848,8.846016e-05,0.0002689367,0.0007626812,0.001066027
                  ,0.0008695347,0.001843275,0.001754963,0.001606053,0.001108502
                  ,0.0007866114,-3.609228e-05,-0.000590232,-0.001623565,-0.002787801
                  ,-0.003636706,-0.003286903,-0.002139162,-0.0009364009,0.0001665399
                  ,0.001581927,0.002005389,0.002445994,0.002639411,0.002526761
                  ,0.002097802,0.001686099,-0.0004083157,-0.001639824,-0.004269938
                  ,-0.005616789,-0.006806914,-0.003885847,-0.003822007,-0.003090216
                  ,-0.001882199,-0.0006310753,1.323087e-05,0.0006080711,0.0002585318
                  ,0.0003351646,0.0006875485,0.001135204,0.001262623,0.001248016
                  ,0.001379004,0.001143839,0.0006657988,-0.000662491,-0.001086544
                  ,-0.001405914,-0.001519471,-0.00164367,-0.001417891,-0.0003618555
                  ,0.0005718038,0.001635704,0.002452552,0.002743425,0.001718018
                  ,0.001956635,0.00182016,0.001229606,0.0007951847,-0.001587254
                  ,-0.002427324,-0.004746052,-0.0058762,-0.007508053,-0.003286132
                  ,-0.0033076,-0.002662089,-0.001633515,-0.00046461,-0.0001752628
                  ,0.0005626709,0.0002822696,0.0003995125,0.000578579,0.001107678
                  ,0.001379616,0.001761213,0.001763258,0.001025162,0.0003195437
                  ,-0.0006543238,-0.001188786,-0.001228883,-0.001104979,-0.0006326919
                  ,-0.0005087161,0.0004657791,0.001420446,0.00239649,0.003289527
                  ,0.003433778,0.002584474,0.002132745,0.001816246,0.001396325
                  ,0.0004726718,-0.001483603,-0.002063205,-0.003590129,-0.004725082
                  ,-0.006117865,-0.002342641,-0.001979853,-0.00115953,-0.0005757302
                  ,0.0002119045,0.0005265695,0.0006401556,0.0004678003,0.0005225881
                  ,0.0009522921,0.001143357,0.001627091,0.002148701,0.001653695
                  ,0.001010261,0.0005227957,0.0002342832,-0.0002048963,-0.0002766697
                  ,-0.0005869101,-0.0003256574,-1.365772e-05,0.0004463901,0.001598524
                  ,0.002528372,0.002949265,0.002935747,0.002050851,0.001266949
                  ,0.0007511054,-0.000402099,-0.00184328,-0.002643111,-0.002982844
                  ,-0.003514526,-0.003671105,-0.004046966,-0.001627169,-0.001475273
                  ,-0.001211126,-0.0009538605,7.561667e-05,-8.763368e-06,-0.0001603707
                  ,-0.0003852772,-0.0004154773,-0.0004070872,-0.0003414853,-0.0004786665
                  ,-0.0005532599,-0.0004262289,-0.0001973173,-0.0005719577,-0.0006440268
                  ,-0.001040983,-0.001360555,-0.001319758,-0.0008255724,-0.0003304626
                  ,0.0001401147,0.0008867217,0.001509578,0.001787813,0.001953764
                  ,0.001715181,0.0008280047,-0.0002526903,-0.00177083,-0.002676223
                  ,-0.002504241,-0.002815028,-0.002655286,-0.001758835,-0.001532176
                  ,-0.001339151,-0.001051057,-0.001391585,-0.001087622,-0.0004486995
                  ,-0.000190917,-0.0006334421,-0.0009350841,-0.0004986529,-0.0005853541
                  ,-0.0005042113,-0.0007795537,-0.001005287,-0.00103285,-0.0009464814
                  ,-0.001252852,-0.001168878,-0.00167684,-0.001962155,-0.002044902
                  ,-0.001802347,-0.001062816,-0.0005998475,0.0001442148,0.001074646
                  ,0.001495043,0.001776593,0.001972507,0.001470786,0.0003118261
                  ,-0.00100887,-0.002277394,-0.002097622,-0.002287859,-0.001670791
                  ,-0.001198194,-0.0006539001,-0.000954308,-0.0006952739,-0.0007340596
                  ,-0.0006591095,-0.0001489224,0.0002984889,2.886971e-05,0.0002438947
                  ,0.0005957691,0.0007732353,0.0007534443,0.0007690222,0.0009426174
                  ,0.001377505,0.001472358,0.001639411,0.001114784,0.0005005861
                  ,0.0002540209,-0.0003322591,-0.0006234338,-0.0007170405,-0.0004051911
                  ,0.00013291,0.001250334,0.001563659,0.002425328,0.002916674
                  ,0.002633441,0.001680908,0.0006730439,-0.0006616683,-0.001646094
                  ,-0.00253863,-0.002132812,-0.002437245,-0.002190498,-0.0006685674
                  ,-0.000644964,-0.0007484664,9.042837e-05,0.001268202,0.00138414
                  ,0.001290659,0.001181579,0.001517721,0.00214736,0.002305428
                  ,0.002672861,0.002934694,0.003299048,0.003490287,0.003311795
                  ,0.002149803,0.001699685,0.001379676,0.0004256961,-0.0002565797
                  ,-0.0004143409,-3.457518e-05,0.0006969437,0.001949988,0.002806523
                  ,0.003232153,0.003284025,0.003069984,0.002165068,0.001718802
                  ,0.000567335,-0.001022567,-0.00190035,-0.002315709,-0.003140022
                  ,-0.002990896,-0.0006304911,-0.000378095,-8.802005e-05,0.0002976308
                  ,0.00136026,0.001438129,0.0008083858,0.0009385686,0.001333951
                  ,0.001897457,0.002000435,0.002169747,0.002691643,0.002897924
                  ,0.003097794,0.002636565,0.001863688,0.002160385,0.001745916
                  ,0.0007364844,-0.000307362,-0.0004056829,-0.0001525698,0.001054993
                  ,0.002256529,0.003575294,0.003886715,0.003999151,0.003500994
                  ,0.00278247,0.002210125,0.0009549033,-0.000609297,-0.001301735
                  ,-0.00216916,-0.002792495,-0.003213777), byrow=TRUE, ncol=37)
  return(res)
}

get_ocean_circ_OXY <- function(){
  res <- matrix(c(232.38053,231.14017,229.3396,228.474645,227.224243333333
                  ,225.49813,228.12038,228.12038,228.12038,224.171765
                  ,224.60741,226.331035,226.331035,226.331035,222.784635
                  ,222.139165,221.0562,219.46516,219.037625,219.71448
                  ,219.71448,219.71448,219.72874,219.72874,219.72874
                  ,218.691556666667,217.86708,219.285716,218.0591375,219.580462
                  ,222.1882,223.7396,220.514326666667,222.964482,217.9866
                  ,217.9866,217.9866,232.38053,231.14017,229.3396
                  ,228.474645,227.224243333333,225.49813,225.78559,226.92464
                  ,224.33429,224.171765,224.60741,224.54399,224.971672
                  ,222.0009,222.784635,222.139165,221.0562,219.46516
                  ,219.037625,218.093185,219.3081975,218.60893,219.027476666667
                  ,218.25082,218.881356666667,218.691556666667,217.86708,219.285716
                  ,218.0591375,219.580462,222.1882,223.7396,220.514326666667
                  ,222.964482,222.685912,224.636115555556,224.10045,232.38053
                  ,231.14017,229.3396,228.474645,227.224243333333,225.49813
                  ,231.794265,231.794265,231.794265,224.171765,235.70459
                  ,229.385275,229.385275,228.17778,228.17778,224.81263
                  ,224.02277,222.46056,221.12027,221.82105,220.09887
                  ,220.09887,219.027476666667,218.73951,218.73951,221.16914
                  ,221.16914,219.285716,221.482365,221.482365,220.231355
                  ,214.9476125,221.286233333333,219.2168225,219.103293333333,221.88907
                  ,221.88907,250.55278,247.788015,247.788015,242.133945
                  ,246.40317,239.60508,234.786613333333,234.786613333333,237.313045
                  ,235.70459,235.70459,236.344,236.08545,228.212885
                  ,228.212885,228.212885,224.02277,222.46056,221.12027
                  ,221.276863333333,221.276863333333,221.276863333333,221.276863333333,218.73951
                  ,218.73951,224.70938,224.70938,224.70938,232.93
                  ,221.482365,220.231355,214.9476125,221.286233333333,219.2168225
                  ,224.615168,224.615168,220.193635,250.55278,247.788015
                  ,247.788015,242.133945,246.40317,239.60508,240.25868
                  ,240.25868,240.25868,244.1,235.70459,239.976473333333
                  ,239.976473333333,239.976473333333,228.212885,239.65081,228.45
                  ,233.7,229.15,225.43096,225.43096,225.43096
                  ,236.3,236.7,232.8,233.25,226.60297
                  ,226.60297,232.93,232.93,232.6,232.6
                  ,226.357753333333,229.35598,229.35598,229.86228,229.86228
                  ,251.876595,251.468433333333,257.35,252.4,251.5
                  ,251.5,232.35,247.44048,246.7,244.1
                  ,242.55,244.5,245.1182675,245.2,246.05
                  ,239.65081,228.45,233.7,229.15,231.95
                  ,228.833732,233.266666666667,236.3,236.7,232.8
                  ,233.25,236.3,231.5,233.75686,231.5
                  ,232.6,232.6,226.357753333333,232.04578,227.355983333333
                  ,228,228,252.193123333333,252.193123333333,253.89298
                  ,251.9,251.9,251.5,251.20589,251.20589
                  ,251.20589,244.1,242.55,249.553773333333,249.553773333333
                  ,249.553773333333,247.865463333333,247.865463333333,247.865463333333,233.7
                  ,229.15,239.489585,239.489585,239.489585,236.3
                  ,236.7,232.8,233.25,236.3,237.26667
                  ,237.26667,237.26667,232.6,235.0003925,235.0003925
                  ,230.0150125,230.0150125,228,228,252.09241
                  ,251.350246666667,251.350246666667,251.1,251.1,253.34643
                  ,250.792276,250.792276,250.792276,251.263756666667,246.78887
                  ,248.22416,248.22416,248.22416,243.26358,243.26358
                  ,243.26358,242.080385,240.81624,240.29788,240.29788
                  ,240.29788,237.493235,236.74546,239.21636,235.77094
                  ,236.46188,233.56842,233.56842,233.56842,234.214095
                  ,234.214095,235.8463675,233.87845,233.87845,226.05782
                  ,228,252.09241,255.357273333333,252.073346,250.787708
                  ,250.565153333333,253.34643,249.36107,250.782254285714,251.10924
                  ,251.263756666667,246.78887,246.9956,247.90068625,248.8289075
                  ,243.884565,245.368766666667,240.96522,242.080385,240.81624
                  ,240.35214,241.476224,239.4901,237.493235,236.74546
                  ,239.21636,235.77094,236.46188,236.00771,235.126026666667
                  ,234.907976666667,230.64889,230.839214,232.03579,227.199265
                  ,225.051873333333,226.05782,226.05782,252.985735,252.312658
                  ,250.293063333333,247.981908888889,246.919925,245.100446666667,244.2571925
                  ,244.365934285714,243.604073333333,244.66546,244.66546,245.880493333333
                  ,245.880493333333,245.880493333333,240.35,238.81939,240.96522
                  ,242.080385,240.81624,238.656606666667,238.656606666667,238.656606666667
                  ,237.493235,236.74546,239.21636,235.77094,236.46188
                  ,230.83417,230.83417,230.83417,227.314206666667,227.314206666667
                  ,227.314206666667,227.199265,222.28276,222.28276,220.944025
                  ,252.985735,252.312658,244.72629,244.72629,244.72629
                  ,245.100446666667,243.52438,243.52438,242.25849,242.25849
                  ,241.25175,240.031305,241.4113025,240.10561,240.35
                  ,238.81939,238.81939,239.46829,239.46829,238.677085
                  ,238.677085,238.677085,234.01624,234.01624,234.01624
                  ,235.77094,230.392915,230.392915,230.392915,230.392915
                  ,226.644263333333,226.644263333333,226.644263333333,226.644263333333,222.28276
                  ,222.28276,220.944025,251.34524,247.96464,248.970472
                  ,248.970472,248.970472,244.323455,244.323455,244.323455
                  ,244.323455,242.25849,241.25175,242.7297825,242.7297825
                  ,242.7297825,240.35,239.06232,239.06232,239.46829
                  ,239.46829,239.118,239.460066,233.282955,234.01624
                  ,234.01624,232.99735,230.76316,230.76316,228.72906
                  ,228.72906,228.72906,223.844615,223.844615,223.844615
                  ,223.844615,225.55185,225.844663333333,230.33902,251.34524
                  ,247.96464,247.409053333333,247.495748571429,247.495748571429,250.87596
                  ,245.469696666667,245.469696666667,245.469696666667,248.70909,249.01152
                  ,245.692113333333,245.692113333333,245.692113333333,241.394703333333,243.6626
                  ,243.411766666667,241.392303333333,240.92387,238.148956666667,238.148956666667
                  ,238.148956666667,236.06916,236.06916,232.99735,230.76316
                  ,230.76316,231.6194,228.5267,227.52079,224.892243333333
                  ,224.892243333333,224.892243333333,226.656176666667,225.55185,225.844663333333
                  ,230.33902,253.72987,253.55578,251.65761,250.89652
                  ,250.386615,250.87596,250.749745,252.329405,249.24994
                  ,248.70909,249.01152,246.208385,247.714316666667,243.09399
                  ,241.394703333333,243.6626,243.411766666667,241.392303333333,240.92387
                  ,239.37192,239.52824,239.31181,236.6178,236.366585
                  ,234.61484,233.206335,232.25586,231.21627,229.500956666667
                  ,230.765615,227.4533,227.089156666667,227.105145,226.656176666667
                  ,225.55185,225.844663333333,230.33902,252.0219,255.30476
                  ,255.95688,253.647025,245.6944,245.6944,251.6813775
                  ,251.6813775,251.6813775,248.70909,249.01152,248.266256666667
                  ,248.266256666667,248.266256666667,241.394703333333,243.6626,243.411766666667
                  ,241.392303333333,240.92387,239.303693333333,239.303693333333,239.303693333333
                  ,236.6178,236.366585,234.61484,233.206335,232.25586
                  ,232.160606666667,232.160606666667,232.160606666667,230.01094,230.01094
                  ,230.01094,226.656176666667,234.67207,231.9972,230.33902
                  ,254.05931,255.30476,246.213086666667,246.213086666667,246.213086666667
                  ,248.27826,246.215725,246.215725,246.215725,246.215725
                  ,243.976333333333,243.976333333333,243.976333333333,243.976333333333,243.976333333333
                  ,247.815825,245.286443333333,244.68211,240.818683333333,240.818683333333
                  ,240.818683333333,240.818683333333,242.8656775,242.8656775,240.112
                  ,240.112,236.295646666667,236.295646666667,236.295646666667,232.160606666667
                  ,232.698683333333,232.698683333333,232.698683333333,234.67207,234.67207
                  ,231.9972,231.9972,254.05931,254.05931,249.5709225
                  ,249.5709225,249.5709225,248.27826,248.27826,249.59834
                  ,249.59834,251.771793333333,250.31945,247.1240975,247.1240975
                  ,247.1240975,248.8175,247.815825,245.286443333333,244.68211
                  ,243.543936666667,243.365755,242.8656775,242.8656775,242.8656775
                  ,241.13977,240.736395,240.112,240.112,240.112
                  ,240.264725,237.971865,238.9384025,238.9384025,238.24815
                  ,237.4125,237.4125,241.26343,241.26343,251.99377
                  ,251.99377,251.819755,250.943754,252.120485,250.836015
                  ,249.25161,252.885188333333,252.395965,251.771793333333,250.31945
                  ,251.63815,250.051104,250.644875,248.8175,247.815825
                  ,245.286443333333,244.68211,243.543936666667,243.365755,242.659626666667
                  ,242.913012,243.5299,241.13977,240.736395,240.78252
                  ,240.13799,240.12812,240.264725,237.971865,240.0213
                  ,240.58821,240.09987,241.486525,237.87384,241.26343
                  ,241.26343,251.99377,251.99377,254.00991,254.00991
                  ,254.00991,250.836015,255.193623333333,255.193623333333,255.193623333333
                  ,256.153415,256.153415,249.248015,249.248015,249.248015
                  ,248.8175,247.815825,245.286443333333,244.68211,243.543936666667
                  ,243.365755,247.0074,247.0074,247.0074,241.13977
                  ,242.881955,242.881955,242.881955,240.12812,243.76286
                  ,243.76286,241.43987,241.43987,240.09987,241.486525
                  ,237.87384,241.26343,241.26343), byrow=TRUE, ncol=37)
  return(res)
}
